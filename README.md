Tried C# implementation but didn't work so ignore
